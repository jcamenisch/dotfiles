orc_random_web_server() {
  WEB_SERVERS=($(cat $UV_RAILS_DIR/config/deploy/production.rb | awk '/role :app/ { print $NF }'))
  echo ${WEB_SERVERS[$RANDOM % ${#WEB_SERVERS[@]}]}
}

safe_alias o orc
safe_alias ods "orc deploy staging \$(git remote -v | awk -F'[/.]' '/origin.*fetch/ { print \$3 }') \$(git symbolic-ref --short HEAD)"

ods_m() {
  for app in $@; do
    orc deploy staging $app master
  done
}

safe_alias om "orc migrate"
safe_alias oms "orc migrate staging"
safe_alias omy "orc mysql \$(orc_random_web_server)"
safe_alias or "orc rails"
safe_alias ors "orc rails staging"
safe_alias orw "orc rails \$(orc_random_web_server)"
safe_alias os "orc ssh"
safe_alias oss "orc ssh staging"
safe_alias osw "orc ssh \$(orc_random_web_server)"
safe_alias ots "orc top staging"
safe_alias ou "orc update"
